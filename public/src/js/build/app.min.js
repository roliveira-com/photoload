var deferredPrompt,enableNotificationBtn=document.querySelectorAll(".enable-notifications");function showSubscription(){navigator.serviceWorker.ready.then(function(i){return reg=i,reg.pushManager.getSubscription()}).then(function(i){console.log("Inscrição do Push Manager",i)})}function displayConfirmNotification(){if("serviceWorker"in navigator){var o={body:"[Service Worker] Você se inscreveu para receber atualizações do nosso aplicativo web!",icon:"/src/images/icons/app-icon-96x96.png",image:"/src/images/sf-boat.jpg",dir:"ltr",lang:"pt-BR",vibrate:[100,50,200],badge:"/src/images/icons/app-icon-96x96.png",tag:"confirm-notification",renotify:!0,actions:[{action:"confirm",title:"OK",icon:"/src/images/icons/app-icon-96x96.png"},{action:"cancel",title:"Cancel",icon:"/src/images/icons/app-icon-96x96.png"}]};navigator.serviceWorker.ready.then(function(i){i.showNotification("Notificações Habilitadas com sucesso!",o)})}}function configureWebPush(){var n;"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(i){return(n=i).pushManager.getSubscription()}).then(function(i){if(null===i){var o=urlBase64ToUint8Array("BApQasJCUpay-LJiLY0wze_7E2iVyXoQ9sNtGNwR1BpwDtmDfL0nL7THitENo-9msuq5vwZqcV2SpWmDQO5FiEk");return n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o})}new Notification("Você já possui inscrição para nossas push messages")}).then(function(i){console.log("Inscrição no Push criada",i),fetch("https://photoload-98c58.firebaseio.com/subscriptions.json",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(i)}).then(function(i){i.ok&&(console.log("Inscrição do Push salva!"),displayConfirmNotification())})}).catch(function(i){console.log(i)})}function askForNotificationPermission(){Notification.requestPermission(function(i){console.log("Escolha do usuário para notificaçoes: ",i),"granted"!==i?console.log("Usuário não concedeu permissões para notificação",i):configureWebPush()})}if(window.Promise||(window.Promise=Promise),"serviceWorker"in navigator&&(navigator.serviceWorker.register("/service-worker.js").then(function(){console.log("Service worker registrado!")}).catch(function(i){console.log(i)}),showSubscription()),window.addEventListener("beforeinstallprompt",function(i){return console.log("beforeinstallprompt disparado"),i.preventDefault(),deferredPrompt=i,!1}),"Notification"in window)for(var i=0;i<enableNotificationBtn.length;i++)enableNotificationBtn[i].style.display="inline-block",enableNotificationBtn[i].addEventListener("click",askForNotificationPermission);